#/bin/bash
echo "Assemble ASM files..."
$HOME/opt/cross/bin/x86_64-elf-as bootstrapping/efi_loader.asm -o bootstrap.o

echo "Compiling C files..."
$HOME/opt/cross/bin/x86_64-elf-gcc -ffreestanding -mcmodel=large -mno-red-zone -mno-mmx -mno-sse -mno-sse2 -c kernel.c -o kernel.o

echo "Linking O files..."
$HOME/opt/cross/bin/x86_64-elf-gcc -ffreestanding -T ./linker.ld bootstrap.o kernel.o -o ./kernel.bin -nostdlib -lgcc

echo "Cleanup"
rm *.o